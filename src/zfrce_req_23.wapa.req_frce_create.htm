<%                                                                                                                                                                                                                                                             
************************************************************************                                                                                                                                                                                       
*	CHANGE HISTORY                                                                                                                                                                                                                                               
************************************************************************                                                                                                                                                                                       
*	DATE CHANGE... 20.11.2006                                                                                                                                                                                                                                    
*	AUTHOR........ Naveen Veshala (GBNVE2)                                                                                                                                                                                                                       
*	CHANGE DESCR.. New Workflow routing changes                                                                                                                                                                                                                  
*	R/3 RELEASE... 4.70                                                                                                                                                                                                                                          
*      Service Center Ticket:GIM01812792                                                                                                                                                                                                                       
*      Change Log ...MOD-001                                                                                                                                                                                                                                   
*	TRANSPORTNR... RT 6939                                                                                                                                                                                                                                       
************************************************************************                                                                                                                                                                                       
%>                                                                                                                                                                                                                                                             
<%@page language="abap" %>                                                                                                                                                                                                                                     
<%@extension name="bsp" prefix="bsp" %>                                                                                                                                                                                                                        
<%@extension name="htmlb" prefix="htmlb" %>                                                                                                                                                                                                                    
<%@extension name="xhtmlb" prefix="xhtmlb" %>                                                                                                                                                                                                                  
<%@extension name="phtmlb" prefix="phtmlb" %>                                                                                                                                                                                                                  
<%@extension name="/DS1/FSS" prefix="zmdm" %>                                                                                                                                                                                                                  
<%                                                                                                                                                                                                                                                             
  data:                                                                                                                                                                                                                                                        
  l_tooltip           type string,        "Used for Help note                                                                                                                                                                                                  
  l_display_only     type string,                                                                                                                                                                                                                              
  ir_layout_service   type ref to /DS1/IF_FSS_BSPLAYOUT_SERVICES,                                                                                                                                                                                              
  lr_disable_tooltip  type string,       "Used for Help note                                                                                                                                                                                                   
  lr_field            type ref to /ds1/cl_fss_bspfield_services,                                                                                                                                                                                               
  lr_view             type ref to if_bsp_page,                                                                                                                                                                                                                 
  l_viewname          type string,                                                                                                                                                                                                                             
  l_text              type string,                                                                                                                                                                                                                             
  lt_helpvalues       type SHSVALTAB,    "Helpvalues for dropdown list box                                                                                                                                                                                     
  l_prefix            type string,        "HTMLB-Prefix                                                                                                                                                                                                        
  l_checkbox_checked  type string,        "Initial value for checkbox (true/false)                                                                                                                                                                             
  l_event             type string,                                                                                                                                                                                                                             
  l_labelwidth        type I,                                                                                                                                                                                                                                  
  l_rowsize_bupa      type string,        "Number of rows BUPA view                                                                                                                                                                                            
  l_fieldstat         type string,                                                                                                                                                                                                                             
  l_selection         type char1,                                                                                                                                                                                                                              
  l_value             type string,                                                                                                                                                                                                                             
  l_display_status    type string VALUE 'FALSE',                                                                                                                                                                                                               
  l_mandatory         type string VALUE 'X',                                                                                                                                                                                                                   
  l_status            type string,                                                                                                                                                                                                                             
  l_unit              type char3,                                                                                                                                                                                                                              
  lw_helpvalues like line of lt_helpvalues,  "Mod-001                                                                                                                                                                                                          
  l_wi_stat      type sww_wistat. "mod-001                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  constants : lc_true type String value 'TRUE',                                                                                                                                                                                                                
              lc_testfail(132) value 'Make correction-testing failed',                                                                                                                                                                                         
              lc_testsuccess(132) value 'Update into Prod-test successful',                                                                                                                                                                                    
              lc_yes(3) value 'YES',                                                                                                                                                                                                                           
              lc_No(2) value 'NO'.                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
  l_rowsize_bupa = 18.                                                                                                                                                                                                                                         
  create object lr_field  exporting ir_page = page.                                                                                                                                                                                                            
  ir_layout_service ?= controller.                                                                                                                                                                                                                             
  l_labelwidth =  ir_layout_service->GET_DEF_LABELWIDTH( ).                                                                                                                                                                                                    
  if not controller->r_f4_data is bound.                                                                                                                                                                                                                       
  create object controller->r_f4_data.                                                                                                                                                                                                                         
  endif.                                                                                                                                                                                                                                                       
%>                                                                                                                                                                                                                                                             
<htmlb:content id     = "c1"                                                                                                                                                                                                                                   
               design = "DESIGN2003" >                                                                                                                                                                                                                         
  <htmlb:document>                                                                                                                                                                                                                                             
    <htmlb:documentHead title="<%= otr(/DS1/FSS_01/FRCE_CREATE) %>" >                                                                                                                                                                                          
      <zmdm:inputHelpDrag/>                                                                                                                                                                                                                                    
    </htmlb:documentHead>                                                                                                                                                                                                                                      
    <htmlb:documentBody>                                                                                                                                                                                                                                       
      <htmlb:form id     = "theForm"                                                                                                                                                                                                                           
                  method = "POST" >                                                                                                                                                                                                                            
        <link REL=stylesheet HREF="../MDM_GENERIC/Style/MDM.css" type="text/css">                                                                                                                                                                              
        <zmdm:tooltip_provider/>                                                                                                                                                                                                                               
        <xhtmlb:protectDoubleSubmit/>                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
     <div id="divButtons" style="position:absolute;left:2;top:2;width:99%;height:25px;                                                                                                                                                                         
                                  background-color:white" class="BorderedArea">                                                                                                                                                                                
                                                                                                                                                                                                                                                               
<!--                                                                                                                                                                                                                                                           
*****************************************************************************************                                                                                                                                                                      
*                    Buttons                                                                                                                                                                                                                                   
*****************************************************************************************                                                                                                                                                                      
//-->                                                                                                                                                                                                                                                          
 <%                                                                                                                                                                                                                                                            
*          CASE controller->r_frce_data->g_workflowstatus.                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
        CASE controller->ms_request_header-req_status.                                                                                                                                                                                                         
          WHEN controller->CO_STATUS_NEW.                                                                                                                                                                                                                      
              l_viewname = '_buttons1.bsp'.                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
          WHEN controller->CO_STATUS_TO_FIMRDREQAPPRVR.                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
*            IF controller->r_frce_data->mv_sendback EQ 'X'.                                                                                                                                                                                                   
*                  l_viewname = '_buttons5.bsp'.                                                                                                                                                                                                               
*             ELSE.                                                                                                                                                                                                                                            
                  l_viewname = '_buttons2.bsp'.                                                                                                                                                                                                                
*              ENDIF.                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
          WHEN controller->CO_STATUS_TO_FIMRDMANAGER.                                                                                                                                                                                                          
              l_viewname = '_buttons3.bsp'.                                                                                                                                                                                                                    
          WHEN controller->CO_STATUS_TO_APPROVER.                                                                                                                                                                                                              
              l_viewname = '_buttons4.bsp'.                                                                                                                                                                                                                    
          WHEN controller->CO_STATUS_TO_REQUESTER.                                                                                                                                                                                                             
              l_viewname = '_buttons6.bsp'.                                                                                                                                                                                                                    
          WHEN others.                                                                                                                                                                                                                                         
              l_viewname = '_buttons4.bsp'.                                                                                                                                                                                                                    
          ENDCASE.                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
* Begin of changes - Mod-001                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
          select single wi_stat into l_wi_stat from swwwihead                                                                                                                                                                                                  
          where wi_id = controller->mv_wi_id.                                                                                                                                                                                                                  
          IF l_wi_stat = 'COMPLETED'.                                                                                                                                                                                                                          
            l_viewname = '_buttons00.bsp'.                                                                                                                                                                                                                     
          ENDIF.                                                                                                                                                                                                                                               
          IF controller->mv_display_only = lc_true.                                                                                                                                                                                                            
              l_viewname = '_buttons00.bsp'.                                                                                                                                                                                                                   
          ENDIF.                                                                                                                                                                                                                                               
* End of changes Mod-001                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
          clear lr_view.                                                                                                                                                                                                                                       
          lr_view = create_view( view_name = l_viewname ).                                                                                                                                                                                                     
          lr_view->set_attribute( name = 'iv_display_only'                                                                                                                                                                                                     
          value = controller->mv_display_only ).                                                                                                                                                                                                               
          lr_view->set_attribute( name = 'IR_LAYOUT_SERVICE'                                                                                                                                                                                                   
          value = ir_layout_service ).                                                                                                                                                                                                                         
          call_view( lr_view ).                                                                                                                                                                                                                                
        %>                                                                                                                                                                                                                                                     
    </div>                                                                                                                                                                                                                                                     
    <div id="divMain"                                                                                                                                                                                                                                          
         style="position:absolute;left:2;top:30;width:99%;height:95%;                                                                                                                                                                                          
                overflow-y:auto;overflow-x:auto;                                                                                                                                                                                                               
                background-color:white" class="BorderedArea">                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
<%-- Begin of changes Mod-001  --%>                                                                                                                                                                                                                            
        <%                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
              if not controller->mt_messages is initial.                                                                                                                                                                                                       
              clear lr_view.                                                                                                                                                                                                                                   
              lr_view = create_view( view_name = '_messages.bsp' ).                                                                                                                                                                                            
              lr_view->set_attribute( name = 'ir_layout_service'                                                                                                                                                                                               
              value = ir_layout_service ).                                                                                                                                                                                                                     
              lr_view->set_attribute( name = 'it_messages'                                                                                                                                                                                                     
              value = controller->mt_messages ).                                                                                                                                                                                                               
              call_view( lr_view ).                                                                                                                                                                                                                            
              endif.                                                                                                                                                                                                                                           
        %>                                                                                                                                                                                                                                                     
<%-- End of changes Mod-001 --%>                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
        <htmlb:group id    = "group_frce"                                                                                                                                                                                                                      
                     title = "<%= otr(/DS1/FSS_01/FRCE_CREATE) %>"                                                                                                                                                                                             
                     width = "100%" >                                                                                                                                                                                                                          
          <htmlb:groupBody>                                                                                                                                                                                                                                    
            <htmlb:gridLayout columnSize = "4"                                                                                                                                                                                                                 
                              rowSize    = "35"                                                                                                                                                                                                                
                              width      = "100%" >                                                                                                                                                                                                            
              <%                                                                                                                                                                                                                                               
  ir_layout_service->SET_COLUMN( IV_COLUMN = 1 ).                                                                                                                                                                                                              
  ir_layout_service->SET_ROW( IV_ROW = 1 ).                                                                                                                                                                                                                    
              %>                                                                                                                                                                                                                                               
              <%-- -------------- Company Code -------------------------------- --%>                                                                                                                                                                           
<%                                                                                                                                                                                                                                                             
if controller->mv_display_only eq 'TRUE'.                                                                                                                                                                                                                      
l_display_only = 'TRUE'.                                                                                                                                                                                                                                       
else.                                                                                                                                                                                                                                                          
l_display_only = 'FALSE'.                                                                                                                                                                                                                                      
endif.                                                                                                                                                                                                                                                         
  ir_layout_service->SET_NEXT_ROW( ).                                                                                                                                                                                                                          
  ir_layout_service->SET_COLUMN( IV_COLUMN = 1 ).                                                                                                                                                                                                              
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
*  call method controller->r_f4_data->GET_VALUES_FOR_COMPANY_CODE "Mod-001                                                                                                                                                                                     
*  receiving rt_f4help   = lt_helpvalues.                         "Mod-001                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
 call method controller->GET_VALUES_FOR_CCODE "Mod-001                                                                                                                                                                                                         
  receiving rt_f4help   = lt_helpvalues.   "Mod-001                                                                                                                                                                                                            
  lr_field->set_field( iv_name  = 'BUKRS'                                                                                                                                                                                                                      
              iv_data           = controller->r_frce_data->MS_FRCE-BUKRS                                                                                                                                                                                       
              iv_label          = 'Company Code'                                                                                                                                                                                                               
              iv_mandatory      = l_mandatory                                                                                                                                                                                                                  
              it_helpvalues     = lt_helpvalues                                                                                                                                                                                                                
              iv_outputlength   = controller->CO_LENGTH_ddlb                                                                                                                                                                                                   
              iv_disabled = l_display_only                                                                                                                                                                                                                     
              iv_prefix         = l_prefix ).                                                                                                                                                                                                                  
              l_tooltip = 'BUKRS'.                                                                                                                                                                                                                             
%>                                                                                                                                                                                                                                                             
   <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
 <%-- -------------- Request Number -------------------------------- --%>                                                                                                                                                                                      
 <%                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
  ir_layout_service->set_column( iv_column = 3 ).                                                                                                                                                                                                              
  lr_field->set_field( iv_name   = 'WORKITEM_ID'                                                                                                                                                                                                               
              iv_data            = controller->MV_WF_ID                                                                                                                                                                                                        
              iv_label           = 'Request #'                                                                                                                                                                                                                 
              iv_disabled        = 'TRUE'                                                                                                                                                                                                                      
              iv_prefix          = l_prefix ).                                                                                                                                                                                                                 
              l_tooltip          = 'SWW_WIID'.                                                                                                                                                                                                                 
 %>                                                                                                                                                                                                                                                            
 <%@include file="cell_with_inputfield.bsp" %>                                                                                                                                                                                                                 
<%-- -------------- Class Of Business-------------------------------- --%>                                                                                                                                                                                     
<%                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  ir_layout_service->SET_NEXT_ROW( ).                                                                                                                                                                                                                          
  ir_layout_service->SET_COLUMN( IV_COLUMN = 1 ).                                                                                                                                                                                                              
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
*Begin of changes Mod-001                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
*  call method controller->GET_VALUES_FOR_CLASS_BUSINESS                                                                                                                                                                                                       
*  receiving re_f4help   = lt_helpvalues.                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
       call method /DS1/CL_MDM_ABAP_UTILITIES=>GET_VALUES_FOR_DDLB                                                                                                                                                                                             
       exporting i_field       = controller->G_COB                                                                                                                                                                                                             
                 I_KEY_IN_TEXT = 'X'                                                                                                                                                                                                                           
                 I_BLANK_LINE  = 'X'                                                                                                                                                                                                                           
       receiving rt_values     = lt_helpvalues.                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
       lw_helpvalues-key = '*'.                                                                                                                                                                                                                                
       lw_helpvalues-value = '* - All Classes of Business'.                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
       append lw_helpvalues to lt_helpvalues.                                                                                                                                                                                                                  
       sort lt_helpvalues by value.                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
*End of changes - Mod-001                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
  lr_field->set_field( iv_name = 'SETCLASS'                                                                                                                                                                                                                    
              iv_id             = 'SETCLASS'                                                                                                                                                                                                                   
              iv_data           = controller->r_frce_data->MS_FRCE-SETCLASS                                                                                                                                                                                    
              iv_label          = 'Class of Business '                                                                                                                                                                                                         
              iv_mandatory      = 'X'                                                                                                                                                                                                                          
              iv_disabled       = l_display_only                                                                                                                                                                                                               
              it_helpvalues     = lt_helpvalues                                                                                                                                                                                                                
              iv_outputlength   = controller->CO_LENGTH_ddlb                                                                                                                                                                                                   
              iv_prefix         = l_prefix ).                                                                                                                                                                                                                  
*              l_tooltip = 'SETCLASS'.                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
*Begin of changes - Mod-001                                                                                                                                                                                                                                    
     l_tooltip = '/DS1/MDM_CLASS_OF_BUSINESS'.                                                                                                                                                                                                                 
                  if lr_field->get_value( ) is initial.                                                                                                                                                                                                        
                       lr_field->set_value( lw_helpvalues-key ).                                                                                                                                                                                               
                  endif.                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
*End of changes Mod001                                                                                                                                                                                                                                         
%>                                                                                                                                                                                                                                                             
 <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
<%-- -------------- Request Status -------------------------------- --%>                                                                                                                                                                                       
<%                                                                                                                                                                                                                                                             
    CASE controller->ms_request_header-req_status .                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
         WHEN controller->CO_STATUS_NEW.                                                                                                                                                                                                                       
              controller->co_formstatus = controller->CO_STATUS_NEWT.                                                                                                                                                                                          
*          WHEN controller->CO_STATUS_TO_FIMRDREQAPPRVR.                                                                                                                                                                                                       
*              controller->co_formstatus = controller->CO_STATUS_SUBAPPT.                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
*          WHEN controller->CO_STATUS_TO_FIMRDMANAGER.                                                                                                                                                                                                         
*              controller->co_formstatus = controller->CO_STATUS_ESCALAT.                                                                                                                                                                                      
*          WHEN controller->CO_STATUS_TO_APPROVER.                                                                                                                                                                                                             
*              controller->co_formstatus = controller->CO_STATUS_APPROT.                                                                                                                                                                                       
*          WHEN controller->CO_STATUS_TO_REQUESTER.                                                                                                                                                                                                            
*             l_viewname = ''.                                                                                                                                                                                                                                 
*          WHEN others.                                                                                                                                                                                                                                        
*              controller->co_formstatus = controller->CO_STATUS_APPROT.                                                                                                                                                                                       
          ENDCASE.                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
              ir_layout_service->set_column( iv_column = 3 ).                                                                                                                                                                                                  
              lr_field->set_field( iv_name = 'REQ_STATUS'                                                                                                                                                                                                      
              iv_id             = 'REQ_STATUS'                                                                                                                                                                                                                 
              iv_data           =  controller->CO_FORMSTATUS                                                                                                                                                                                                   
              iv_label          = 'Status'                                                                                                                                                                                                                     
              iv_mandatory      = 'O'                                                                                                                                                                                                                          
              iv_disabled       = 'TRUE'                                                                                                                                                                                                                       
              iv_prefix         = l_prefix ).                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
              l_tooltip = '/DS1/ZFRC_REQ_STATUS'.                                                                                                                                                                                                              
 %>                                                                                                                                                                                                                                                            
   <%@include file="cell_with_inputfield.bsp" %>                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
<%-- -------------- General Form Category-------------------------------- --%>                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
 <%                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
  ir_layout_service->SET_NEXT_ROW( ).                                                                                                                                                                                                                          
  ir_layout_service->SET_COLUMN( IV_COLUMN = 1 ).                                                                                                                                                                                                              
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
  call method controller->GET_VALUES_FOR_GET_FORM_CAT                                                                                                                                                                                                          
  receiving re_f4help   = lt_helpvalues.                                                                                                                                                                                                                       
  lr_field->set_field( iv_name          = 'FRC_REQ_CAT'                                                                                                                                                                                                        
                       iv_id            = 'FRC_REQ_CAT'                                                                                                                                                                                                        
                       iv_data          = controller->r_frce_data->MS_FRCE-FRC_REQ_CAT                                                                                                                                                                         
                       iv_label         = 'General form Categeory'                                                                                                                                                                                             
                       iv_mandatory     =  'X'                                                                                                                                                                                                                 
                       it_helpvalues    = lt_helpvalues                                                                                                                                                                                                        
                       iv_disabled      = l_display_only                                                                                                                                                                                                       
                       iv_outputlength  = controller->CO_LENGTH_ddlb                                                                                                                                                                                           
                       iv_prefix        = l_prefix ).                                                                                                                                                                                                          
  l_tooltip = '/DS1/ZFRC_REQ_CAT'.                                                                                                                                                                                                                             
 %>                                                                                                                                                                                                                                                            
     <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
<%-- ------------------------ Type of Request --------------------------- --%>                                                                                                                                                                                 
 <%                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
  ir_layout_service->SET_NEXT_ROW( ).                                                                                                                                                                                                                          
  ir_layout_service->SET_COLUMN( IV_COLUMN = 1 ).                                                                                                                                                                                                              
  call method controller->get_values_for_type_of_request                                                                                                                                                                                                       
  receiving re_f4help   = lt_helpvalues.                                                                                                                                                                                                                       
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
  lr_field->set_field( iv_name    = 'FRC_REQ_TYPE'                                                                                                                                                                                                             
  iv_id            = 'FRC_REQ_TYPE'                                                                                                                                                                                                                            
  iv_data          = controller->r_frce_data->MS_FRCE-FRC_REQ_TYPE                                                                                                                                                                                             
  iv_label         = 'Request Type'                                                                                                                                                                                                                            
  iv_mandatory     = l_mandatory                                                                                                                                                                                                                               
  it_helpvalues     = lt_helpvalues                                                                                                                                                                                                                            
  iv_disabled      = l_display_only                                                                                                                                                                                                                            
  iv_outputlength  = controller->CO_LENGTH_ddlb                                                                                                                                                                                                                
  iv_prefix        = l_prefix ).                                                                                                                                                                                                                               
  l_tooltip = '/DS1/ZFRC_REQ_TYPE'.                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
 %>                                                                                                                                                                                                                                                            
     <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                        
<%-- -------------- Define Other request-------------------------------- --%>                                                                                                                                                                                  
<%                                                                                                                                                                                                                                                             
if controller->mv_display_only eq 'TRUE'.                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
l_display_only = 'TRUE'.                                                                                                                                                                                                                                       
else.                                                                                                                                                                                                                                                          
l_display_only = 'FALSE'.                                                                                                                                                                                                                                      
endif.                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
  ir_layout_service->set_next_row( ).                                                                                                                                                                                                                          
  ir_layout_service->set_column( iv_column = 1 ).                                                                                                                                                                                                              
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
  lr_field->set_field( iv_name     = 'FRC_REQ_OTHER'                                                                                                                                                                                                           
  iv_id       = 'FRC_REQ_OTHER'                                                                                                                                                                                                                                
  iv_data     = controller->r_frce_data->MS_FRCE-FRC_REQ_OTHER                                                                                                                                                                                                 
  iv_label    = 'Define Other Request'                                                                                                                                                                                                                         
  iv_disabled = l_display_only                                                                                                                                                                                                                                 
  iv_prefix = l_prefix ).                                                                                                                                                                                                                                      
  l_tooltip = '/DS1/ZFRC_REQ_TYPE_OTHER'.                                                                                                                                                                                                                      
%>                                                                                                                                                                                                                                                             
    <%@include file="cell_with_justification_inputfield.bsp" %>                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
<%-- Begin of changes Mod-001 --%>                                                                                                                                                                                                                             
<%-- -------------- Tax Request-------------------------------- --%>                                                                                                                                                                                           
<%                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  ir_layout_service->set_next_row( ).                                                                                                                                                                                                                          
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
  ir_layout_service->set_column( iv_column = 1 ).                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
         clear lt_helpvalues.                                                                                                                                                                                                                                  
       lw_helpvalues-key =  controller->CO_YES.                                                                                                                                                                                                                
       lw_helpvalues-value = lc_yes.                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
       append lw_helpvalues to lt_helpvalues.                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
       lw_helpvalues-key =  controller->CO_NO.                                                                                                                                                                                                                 
       lw_helpvalues-value = lc_no.                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
       append lw_helpvalues to lt_helpvalues.                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
       sort lt_helpvalues by value.                                                                                                                                                                                                                            
       insert initial line into lt_helpvalues index 1.                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
  lr_field->set_field( iv_name = 'G_TAXFLAG'                                                                                                                                                                                                                   
              iv_id             = 'G_TAXFLAG'                                                                                                                                                                                                                  
              iv_data           = controller->g_taxflag                                                                                                                                                                                                        
              iv_label          = 'Tax Request '                                                                                                                                                                                                               
              iv_mandatory      = l_mandatory                                                                                                                                                                                                                  
              iv_disabled       = 'FALSE'                                                                                                                                                                                                                      
              it_helpvalues     = lt_helpvalues                                                                                                                                                                                                                
              iv_outputlength   = controller->CO_LENGTH_ddlb                                                                                                                                                                                                   
              iv_prefix         = l_prefix ).                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
 lr_field->set_onselect( iv_onselect = 'myselect' ).                                                                                                                                                                                                           
         %>                                                                                                                                                                                                                                                    
  <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
 <%-- -------------- Update Test Status-------------------------------- --%>                                                                                                                                                                                   
<%                                                                                                                                                                                                                                                             
if controller->g_taxflag eq 'Y' .                                                                                                                                                                                                                              
  ir_layout_service->set_next_row( ).                                                                                                                                                                                                                          
  l_prefix = controller->get_prefix_for_structure( 'MS_FRCE' ).                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
   if controller->g_resend_flag eq 'X' and                                                                                                                                                                                                                     
      controller->ms_request_header-req_status eq controller->CO_STATUS_TO_REQUESTER.                                                                                                                                                                          
      l_mandatory = 'X'.                                                                                                                                                                                                                                       
       else.                                                                                                                                                                                                                                                   
      l_mandatory = ''.                                                                                                                                                                                                                                        
      endif.                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
   if controller->g_resend_flag eq 'X' and                                                                                                                                                                                                                     
      controller->ms_request_header-req_status eq controller->CO_STATUS_TO_REQUESTER.                                                                                                                                                                          
   "OR controller->ms_request_header-req_status eq controller->C_STATUS_TO_approver.                                                                                                                                                                           
                                                                                                                                                                                                                                                               
   l_display_only = 'FALSE'.                                                                                                                                                                                                                                   
   else.                                                                                                                                                                                                                                                       
   l_display_only = 'TRUE'.                                                                                                                                                                                                                                    
   endif.                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
       clear lt_helpvalues.                                                                                                                                                                                                                                    
       lw_helpvalues-key =  controller->CO_TAX_TEST_SUCCESS.                                                                                                                                                                                                   
       lw_helpvalues-value = lc_testsuccess.                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
       append lw_helpvalues to lt_helpvalues.                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
       lw_helpvalues-key =  controller->CO_TAX_TEST_FAIL.                                                                                                                                                                                                      
       lw_helpvalues-value = lc_testfail.                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
       append lw_helpvalues to lt_helpvalues.                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
       sort lt_helpvalues by value.                                                                                                                                                                                                                            
        insert initial line into lt_helpvalues index 1.                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
  lr_field->set_field( iv_name = 'G_TAX_TEST_STATUS'                                                                                                                                                                                                           
              iv_id             = 'G_TAX_TEST_STATUS'                                                                                                                                                                                                          
              iv_data           = controller->G_TAX_TEST_STATUS                                                                                                                                                                                                
              iv_label          = 'Test Result '                                                                                                                                                                                                               
              iv_mandatory      = l_mandatory                                                                                                                                                                                                                  
              iv_disabled       = l_display_only                                                                                                                                                                                                               
              it_helpvalues     = lt_helpvalues                                                                                                                                                                                                                
              iv_outputlength   = controller->CO_LENGTH_ddlb                                                                                                                                                                                                   
              iv_prefix         = l_prefix ).                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
%>                                                                                                                                                                                                                                                             
 <%@include file="cell_with_inputfield_ddlb.bsp" %>                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
<%endif. %>                                                                                                                                                                                                                                                    
<%-- End of changes Mod-001 --%>                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
         </htmlb:gridLayout>                                                                                                                                                                                                                                   
        </htmlb:groupBody>                                                                                                                                                                                                                                     
       </htmlb:group>                                                                                                                                                                                                                                          
 <%-- ---------------------- Check Mandatory fields -------------------------- --%>                                                                                                                                                                            
        <script type="text/javascript"                                                                                                                                                                                                                         
                language="JavaScript"                                                                                                                                                                                                                          
                src="../MDM_GENERIC/Javascript/TabStripRequiredFields.js">                                                                                                                                                                                     
        </script>                                                                                                                                                                                                                                              
        <%-- ------------------- Begin displaying tab strips ------------------------ --%>                                                                                                                                                                     
        <xhtmlb:tabStrip id                       = "ts1"                                                                                                                                                                                                      
                         dropDownListVisible      = "True"                                                                                                                                                                                                     
                         brandingNotchVisible     = "True"                                                                                                                                                                                                     
                         renderSingleTabAsHeading = "False"                                                                                                                                                                                                    
                         flowIndicatorVisible     = "True"                                                                                                                                                                                                     
                         selection                = "<%= controller->r_frce_data->mv_defaulttab %>"                                                                                                                                                            
                         width                    = "100%" >                                                                                                                                                                                                   
          <%-- -------------- TABSTRIP: REQUESTOR ----------------------------------- --%>                                                                                                                                                                     
          <xhtmlb:tabStripItem title = "<%= otr(/DS1/FSS_01/FRCE_REQUESTOR) %>"                                                                                                                                                                                
                               name  = "_requestor" >                                                                                                                                                                                                          
            <%                                                                                                                                                                                                                                                 
  lr_view = create_view( view_name = '_requestor.bsp' ).                                                                                                                                                                                                       
  lr_view->set_attribute( name = 'ir_layout_service'   value = ir_layout_service ).                                                                                                                                                                            
  lr_view->set_attribute( name = 'iv_display_only'     value = controller->mv_display_only ).                                                                                                                                                                  
  lr_view->set_attribute( name = 'IS_FRCE'             value = controller->r_frce_data->MS_FRCE ).                                                                                                                                                             
  lr_view->set_attribute( name = 'iS_REQUEST_HEADER'   value = controller->MS_REQUEST_HEADER ).                                                                                                                                                                
  lr_view->set_attribute( name = 'iv_labelwidth'       value = l_labelwidth ).                                                                                                                                                                                 
  call_view( lr_view ).                                                                                                                                                                                                                                        
            %>                                                                                                                                                                                                                                                 
            <br/>                                                                                                                                                                                                                                              
          </xhtmlb:tabStripItem>                                                                                                                                                                                                                               
          <%-- -------------- TABSTRIP: APPROVER ----------------------------------- --%>                                                                                                                                                                      
          <xhtmlb:tabStripItem title = "<%= otr(/DS1/FSS_01/FRCE_APPROVER) %>"                                                                                                                                                                                 
                               name  = "_approver" >                                                                                                                                                                                                           
            <%                                                                                                                                                                                                                                                 
  lr_view = create_view( view_name = '_approver.bsp' ).                                                                                                                                                                                                        
  lr_view->set_attribute( name = 'ir_layout_service'   value = ir_layout_service ).                                                                                                                                                                            
  lr_view->set_attribute( name = 'IS_FRCE'             value = controller->r_frce_data->MS_FRCE ).                                                                                                                                                             
  call_view( lr_view ).                                                                                                                                                                                                                                        
            %>                                                                                                                                                                                                                                                 
            <br/>                                                                                                                                                                                                                                              
          </xhtmlb:tabStripItem>                                                                                                                                                                                                                               
          <%-- -------------- TABSTRIP: MRD Analyst ----------------------------------- --%>                                                                                                                                                                   
          <xhtmlb:tabStripItem title = "<%= otr(/DS1/FSS_01/FRCE_MRD) %>"                                                                                                                                                                                      
                               name  = "_mrdanalyst" >                                                                                                                                                                                                         
            <%                                                                                                                                                                                                                                                 
  lr_view = create_view( view_name = '_mrdanalyst.bsp' ).                                                                                                                                                                                                      
  lr_view->set_attribute( name = 'ir_layout_service'   value = ir_layout_service ).                                                                                                                                                                            
  lr_view->set_attribute( name = 'IS_FRCE'             value = controller->r_frce_data->MS_FRCE ).                                                                                                                                                             
  call_view( lr_view ).                                                                                                                                                                                                                                        
            %>                                                                                                                                                                                                                                                 
            <br/>                                                                                                                                                                                                                                              
          </xhtmlb:tabStripItem>                                                                                                                                                                                                                               
          <%-- -------------- TABSTRIP: Requestor Data ----------------------------------- --%>                                                                                                                                                                
          <xhtmlb:tabStripItem title = "<%= otr(/DS1/FSS_01/FRCE_REQ) %>"                                                                                                                                                                                      
                               name  = "_requestor_dat" >                                                                                                                                                                                                      
            <%                                                                                                                                                                                                                                                 
  lr_view = create_view( view_name = '_requestor_dat.bsp' ).                                                                                                                                                                                                   
  lr_view->set_attribute( name = 'ir_layout_service'   value = ir_layout_service ).                                                                                                                                                                            
  lr_view->set_attribute( name = 'iS_REQUEST_HEADER'   value = controller->MS_REQUEST_HEADER ).                                                                                                                                                                
  lr_view->set_attribute( name = 'IS_REQUESTOR_DETAIL' value = controller->MS_REQUESTOR_DETAIL ).                                                                                                                                                              
  lr_view->set_attribute( name = 'iv_display_only'     value = controller->mv_display_only ).                                                                                                                                                                  
  call_view( lr_view ).                                                                                                                                                                                                                                        
            %>                                                                                                                                                                                                                                                 
            <br/>                                                                                                                                                                                                                                              
          </xhtmlb:tabStripItem>                                                                                                                                                                                                                               
          <%-- -------------- TABSTRIP: Message ----------------------------------- --%>                                                                                                                                                                       
          <xhtmlb:tabStripItem title = "<%= otr(/DS1/FSS_01/MESSAGES) %>"                                                                                                                                                                                      
                               name  = "_message" >                                                                                                                                                                                                            
            <%                                                                                                                                                                                                                                                 
  lr_view = create_view( view_name = '_message.bsp' ).                                                                                                                                                                                                         
  lr_view->set_attribute( name = 'ir_layout_service'   value = ir_layout_service ).                                                                                                                                                                            
  lr_view->set_attribute( name = 'iS_REQUEST_HEADER'   value = controller->MS_REQUEST_HEADER ).                                                                                                                                                                
  lr_view->set_attribute( name = 'iv_display_only'     value = controller->mv_display_only ).                                                                                                                                                                  
  lr_view->set_attribute( name = 'it_notes'            value = controller->MT_NOTES ).                                                                                                                                                                         
  lr_view->set_attribute( name = 'is_new_note'         value = controller->ms_new_note ).                                                                                                                                                                      
  call_view( lr_view ).                                                                                                                                                                                                                                        
            %>                                                                                                                                                                                                                                                 
            <br/>                                                                                                                                                                                                                                              
          </xhtmlb:tabStripItem>                                                                                                                                                                                                                               
        </xhtmlb:tabStrip>                                                                                                                                                                                                                                     
 <%* --------------------- MESSAGES   -------------------------%>                                                                                                                                                                                              
 <%-- begin of changes - Mod-001 --%>                                                                                                                                                                                                                          
        <%                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
*              if not controller->mt_messages is initial.                                                                                                                                                                                                      
*              clear lr_view.                                                                                                                                                                                                                                  
*              lr_view = create_view( view_name = '_messages.bsp' ).                                                                                                                                                                                           
*              lr_view->set_attribute( name = 'ir_layout_service'                                                                                                                                                                                              
*              value = ir_layout_service ).                                                                                                                                                                                                                    
*              lr_view->set_attribute( name = 'it_messages'                                                                                                                                                                                                    
*              value = controller->mt_messages ).                                                                                                                                                                                                              
*              call_view( lr_view ).                                                                                                                                                                                                                           
*              endif.                                                                                                                                                                                                                                          
        %>                                                                                                                                                                                                                                                     
 <%-- End of changes - Mod-001 --%>                                                                                                                                                                                                                            
 <%-- ----------- Flag MV_XMSG040_SENT (invisible field) -------------- --%>                                                                                                                                                                                   
        <%                                                                                                                                                                                                                                                     
          l_prefix = controller->GET_PREFIX_FOR_STRUCTURE( 'ATTR' ).                                                                                                                                                                                           
          lr_field->set_field( iv_name         = 'MV_XMSG040_SENT'                                                                                                                                                                                             
          iv_data         = controller->MV_XMSG040_SENT                                                                                                                                                                                                        
          iv_prefix       = l_prefix ).                                                                                                                                                                                                                        
                %>                                                                                                                                                                                                                                             
                <%@include file="invisible_field.bsp" %>                                                                                                                                                                                                       
        <%-- ----------- reinitialize the default tab -------------- --%>                                                                                                                                                                                      
        <%                                                                                                                                                                                                                                                     
              controller->r_frce_data->mv_defaulttab = ''.                                                                                                                                                                                                     
        %>                                                                                                                                                                                                                                                     
        </div>                                                                                                                                                                                                                                                 
      </htmlb:form>                                                                                                                                                                                                                                            
    </htmlb:documentBody>                                                                                                                                                                                                                                      
  </htmlb:document>                                                                                                                                                                                                                                            
</htmlb:content>                                                                                                                                                                                                                                               